system:
  name: "ridersense"
  log_level: "debug"
  log_dir: "/tmp/ridersense/logs"
  data_dir: "/tmp/ridersense/data"
  models_dir: "./models"

sync:
  max_time_diff_ms: 50
  buffer_size: 100
  imu_resample_hz: 200
  gps_resample_hz: 10

perception:
  slam:
    enabled: true
    vocabulary_path: "./models/ORBvoc.txt"
    mode: "monocular" # simple odometry
  detector:
    enabled: true
    model_path: "./models/yolov5s.onnx"
    confidence_threshold: 0.5
    nms_threshold: 0.4
    input_size: 640
  lane:
    enabled: true
    roi_top_ratio: 0.6
    canny_low: 50
    canny_high: 150
    hough_threshold: 50

fusion:
  pose_fusion:
    enabled: true
    process_noise_position: 0.1
    process_noise_velocity: 0.5
    process_noise_orientation: 0.01
    slam_position_noise: 0.05
    gps_position_noise: 5.0
    imu_noise: 0.1

  vehicle_state:
    enabled: true
    wheelbase: 1.5
    cg_height: 0.6
    max_lean_angle: 50.0
    lean_noise: 1.0

services:
  camera:
    enabled: false
    device_id: 0
    width: 640
    height: 480
    fps: 30
  imu:
    enabled: false
    rate_hz: 100
  gps:
    enabled: false
    rate_hz: 10
  frame_logger:
    enabled: true
  time_aligner:
    enabled: true
  slam:
    enabled: false # TODO: enable when ORB is ready
  detector:
    enabled: false
  lane_detector:
    enabled: false
  event_detector:
    enabled: true
  metrics_collector:
    enabled: true
  state_server:
    enabled: true
  state_broadcaster:
    enabled: true

analytics:
  event_detector:
    hard_brake_threshold: -6.0
    hard_accel_threshold: 4.0
    max_lean_threshold: 45.0
    close_object_distance: 5.0
    high_slip_threshold: 10.0
    cooldown_seconds: 2.0
  metrics:
    window_seconds: 60

network:
  state_server:
    port: 9000
    max_clients: 10
  broadcaster:
    rate_hz: 10
